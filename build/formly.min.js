!function(a,b,c){"use strict";angular.module("ambersive.formly",["formly","ngFileUpload","ambersive.helper"]),angular.module("ambersive.formly").config(["formlyConfigProvider",function(a){a.setType({name:"upload",templateUrl:"src/views/formly.upload.html",controller:"FormlyUploadCtrl as FormlyUpload"})}]),angular.module("ambersive.formly").provider("$formlyAdditionallySettings",[function(){var a="",b="",d=function(b){b!==c&&(a=b)},e=function(a){a!==c&&(b=a)};return{setUploadUrl:d,setPreviewUrl:e,$get:function(){return{uploadUrl:a,previewUrl:b}}}}]),angular.module("ambersive.formly").controller("FormlyUploadCtrl",["$rootScope","$scope","$log","Upload","$formlyAdditionallySettings",function(a,b,d,e,f){var g=this,h={};g.field="",g.disabled=!1,g.preview="",g.init=function(a,b,d){h=a;var e='<button class="btn btn-default" ng-disabled="FormlyUpload.disabled" ',i="";if(i=a.preview!==c&&a.preview.url!==c?a.preview.url+b[d]:f.previewUrl+b[d],e+=a.multiple===!0?' multiple ngf-select="FormlyUpload.uploadFiles($event,$files)"':' ngf-select="FormlyUpload.uploadFile($event,$file)"',e+=">"+a.button+"</button>",g.field=e,b[d]!==c&&""!==b[d]&&h.preview!==c&&h.preview.type!==c){var j="";switch(h.preview.type){case"image":j=i,g.preview='<div class="image_container"><img class="img-responsive" src="'+j+'" alt="Preview Image"></div>';break;default:g.preview="<p>"+b[d]+"</p>"}}},g.doUpload=function(a,b){g.disabled=!0;var i=f.uploadUrl,j={file:a};if(h.url!==c&&(i=h.url),h.uploadParams!==c)for(var k in h.uploadParams)"file"!==k&&(j[k]=h.uploadParams[k]);e.upload({url:i,data:j}).then(function(a){g.broadcast(a),b&&b(!0)},function(a){g.broadcast(a),b&&b(!1)},function(a){var b=parseInt(100*a.loaded/a.total);d.log("progress: "+b+"% "+a.config.data.file.name)})},g.uploadFile=function(a,b,c){a.preventDefault(),g.doUpload(b,function(a){g.disabled=!1})},g.uploadFiles=function(a,b){a.preventDefault();var c=0;if(b&&b.length)for(var e=0;e<b.length;e++)g.doUpload(b[e],function(a){c++,c===b.length&&(g.disabled=!1)});else d.warn("no files detected")},g.broadcast=function(b){var d="",e="";h.unique!==c&&""!==h.unqiue&&(d=h.unique),e="formlyUpload"+d.toUpperCase(),a.$broadcast(e,{result:b.data,settings:h,unique:d})}}]),angular.module("ambersive.formly").run(["$rootScope","$log",function(a,b){}])}(window,document,void 0),angular.module("ambersive.formly").run(["$templateCache",function(a){"use strict";a.put("src/views/formly.upload.html","<div class=formly_upload ng-init=FormlyUpload.init(to,model,options.key)><label class=control-label ng-if=to.label>{{to.label}}</label><div compile=FormlyUpload.preview></div><div compile=FormlyUpload.field></div><input type=hidden ng-model=model[options.key]><p ng-if=to.help><small>{{to.help}}</small></p></div>")}]);